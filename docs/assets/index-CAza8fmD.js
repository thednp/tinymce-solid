import{ssr as R,ssrHydrationKey as A,ssrAttribute as I,escape as S}from"solid-js/web";import{createSignal as L,onMount as J,onCleanup as q}from"solid-js";import*as n from"prop-types";const Q="/_build/assets/tinymce-D3UUgicw.js",F={onActivate:n.func,onAddUndo:n.func,onBeforeAddUndo:n.func,onBeforeExecCommand:n.func,onBeforeGetContent:n.func,onBeforeRenderUI:n.func,onBeforeSetContent:n.func,onBeforePaste:n.func,onBlur:n.func,onChange:n.func,onClearUndos:n.func,onClick:n.func,onContextMenu:n.func,onCommentChange:n.func,onCompositionEnd:n.func,onCompositionStart:n.func,onCompositionUpdate:n.func,onCopy:n.func,onCut:n.func,onDblclick:n.func,onDeactivate:n.func,onDirty:n.func,onDrag:n.func,onDragDrop:n.func,onDragEnd:n.func,onDragGesture:n.func,onDragOver:n.func,onDrop:n.func,onExecCommand:n.func,onFocus:n.func,onFocusIn:n.func,onFocusOut:n.func,onGetContent:n.func,onHide:n.func,onInit:n.func,onInput:n.func,onKeyDown:n.func,onKeyPress:n.func,onKeyUp:n.func,onLoadContent:n.func,onMouseDown:n.func,onMouseEnter:n.func,onMouseLeave:n.func,onMouseMove:n.func,onMouseOut:n.func,onMouseOver:n.func,onMouseUp:n.func,onNodeChange:n.func,onObjectResizeStart:n.func,onObjectResized:n.func,onObjectSelected:n.func,onPaste:n.func,onPostProcess:n.func,onPostRender:n.func,onPreProcess:n.func,onProgressState:n.func,onRedo:n.func,onRemove:n.func,onReset:n.func,onSaveContent:n.func,onSelectionChange:n.func,onSetAttrib:n.func,onSetContent:n.func,onShow:n.func,onSubmit:n.func,onUndo:n.func,onVisualAid:n.func,onSkinLoadError:n.func,onThemeLoadError:n.func,onModelLoadError:n.func,onPluginLoadError:n.func,onIconsLoadError:n.func,onLanguageLoadError:n.func,onScriptsLoad:n.func,onScriptsLoadError:n.func},W={apiKey:n.string,licenseKey:n.string,id:n.string,inline:n.bool,init:n.object,initialValue:n.string,onEditorChange:n.func,value:n.string,tagName:n.string,tabIndex:n.number,cloudChannel:n.string,plugins:n.oneOfType([n.string,n.array]),toolbar:n.oneOfType([n.string,n.array]),disabled:n.bool,textareaName:n.string,tinymceScriptSrc:n.oneOfType([n.string,n.arrayOf(n.string),n.arrayOf(n.shape({src:n.string,async:n.bool,defer:n.bool}))]),rollback:n.oneOfType([n.number,n.oneOf([!1])]),scriptLoading:n.shape({async:n.bool,defer:n.bool,delay:n.number}),...F},x=o=>typeof o=="function",j=o=>o in F,H=o=>o.substr(2),X=(o,e,i,a,c,l,s)=>{const u=Object.keys(c).filter(j),y=Object.keys(l).filter(j),b=u.filter(m=>l[m]===void 0),C=y.filter(m=>c[m]===void 0);b.forEach(m=>{const g=H(m),f=s[g];i(g,f),delete s[g]}),C.forEach(m=>{const g=a(o,m),f=H(m);s[f]=g,e(f,g)})},Y=(o,e,i,a,c)=>X(c,o.on.bind(o),o.off.bind(o),(l,s)=>u=>l(s)?.(u,o),e,i,a);let U=0;const N=o=>{const e=Date.now(),i=Math.floor(Math.random()*1e9);return U++,o+"_"+i+U+String(e)},V=o=>o!==null&&(o.tagName.toLowerCase()==="textarea"||o.tagName.toLowerCase()==="input"),z=o=>typeof o>"u"||o===""?[]:Array.isArray(o)?o:o.split(" "),Z=(o,e)=>z(o).concat(z(e)),nn=()=>window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function",en=o=>{if(!("isConnected"in Node.prototype)){let e=o,i=o.parentNode;for(;i!=null;)e=i,i=e.parentNode;return e===o.ownerDocument}return o.isConnected},on=(o,e)=>{o!==void 0&&(o.mode!=null&&typeof o.mode=="object"&&typeof o.mode.set=="function"?o.mode.set(e):o.setMode(e))},tn=(o,e,i)=>{const a=o.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=e.id,a.src=e.src,a.async=e.async??!1,a.defer=e.defer??!1;const c=()=>{a.removeEventListener("load",c),a.removeEventListener("error",l),i(e.src)},l=s=>{a.removeEventListener("load",c),a.removeEventListener("error",l),i(e.src,s)};a.addEventListener("load",c),a.addEventListener("error",l),o.head&&o.head.appendChild(a)},rn=o=>{let e={};const i=(s,u)=>{const y=e[s];y.done=!0,y.error=u;for(const b of y.handlers)b(s,u);y.handlers=[]};return{loadScripts:(s,u,y)=>{const b=f=>y!==void 0?y(f):console.error(f);if(s.length===0){b(new Error("At least one script must be provided"));return}let C=0,m=!1;const g=(f,h)=>{m||(h?(m=!0,b(h)):++C===s.length&&u())};for(const f of s){const h=e[f.src];if(h)h.done?g(f.src,h.error):h.handlers.push(g);else{const D=N("tiny-");e[f.src]={id:D,src:f.src,done:!1,error:null,handlers:[g]},tn(o,{id:D,...f},i)}}},deleteScripts:()=>{for(const s of Object.values(e)){const u=o.getElementById(s.id);u!=null&&u.tagName==="SCRIPT"&&u.parentNode?.removeChild(u)}e={}},getDocument:()=>o}},cn=()=>{const o=[],e=c=>{let l=o.find(s=>s.getDocument()===c);return l===void 0&&(l=rn(c),o.push(l)),l};return{loadList:(c,l,s,u,y)=>{const b=()=>e(c).loadScripts(l,u,y);s>0?setTimeout(b,s):b()},reinitialize:()=>{for(let c=o.pop();c!=null;c=o.pop())c.deleteScripts()}}},sn=cn(),K=o=>{const e=o;return e&&e.tinymce?e.tinymce:null};var an=["<div",' style="','"',"></div>"],ln=["<textarea",' style="','"',"></textarea>"];const un=o=>{const e={...o,tinymceScriptSrc:Q},[i,a]=L(),[c,l]=L(),[s,u]=L(),[y,b]=L(),[C,m]=L({}),g=()=>e?.elementRef?.ownerDocument.defaultView??window,f=()=>typeof e.initialValue=="string"?e.initialValue:typeof e.value=="string"?e.value:"",h=()=>{const r=e.scriptLoading?.async,t=e.scriptLoading?.defer;if(e.tinymceScriptSrc!==void 0)return typeof e.tinymceScriptSrc=="string"?[{src:e.tinymceScriptSrc,async:r,defer:t}]:e.tinymceScriptSrc.map(v=>typeof v=="string"?{src:v,async:r,defer:t}:v);const d=e.cloudChannel||"7";return[{src:`https://cdn.tiny.cloud/1/${e.apiKey?e.apiKey:"no-api-key"}/tinymce/${d}/tinymce.min.js`,async:r,defer:t}]},D=r=>{if(i()!==void 0){const t=i();Y(t,r,e,C(),v=>e[v]);const d=v=>v.onEditorChange!==void 0||v.value!==void 0,k=d(r),p=d(e);!k&&p?(t.on(O(),E),t.on(B(),w),t.on("keydown",P),t.on("keyup",M),t.on("NewBlock",E)):k&&!p&&(t.off(O(),E),t.off(B(),w),t.off("keydown",P),t.off("keyup",M),t.off("NewBlock",E))}},T=(r=0)=>{const t=e.elementRef;if(!t)return;if(!en(t)){if(r===0)setTimeout(()=>T(1),1);else if(r<100)setTimeout(()=>T(r+1),100);else throw new Error("tinymce can only be initialised when in a document");return}const d=K(g());if(!d)throw new Error("tinymce should have been loaded into global scope");const k={...e.init,selector:void 0,target:t,skin:e.skin||"oxide",content_css:e.contentCss||"default",readonly:e.disabled,inline:e.inline,plugins:Z(e.init?.plugins,e.plugins),toolbar:e.toolbar??e.init?.toolbar,...e.licenseKey?{license_key:e.licenseKey}:{},setup:p=>{a(p),D({}),e.inline&&!V(t)&&p.once("PostRender",v=>{p.setContent(f(),{no_events:!0})}),e.init&&x(e.init.setup)&&e.init.setup(p)},init_instance_callback:p=>{const v=f();let _=c()??p.getContent();_!==v&&(_=v,p.setContent(v),p.undoManager.clear(),p.undoManager.add(),p.setDirty(!1)),l(_);const G=e.disabled??!1;on(p,G?"readonly":"design"),e.init&&x(e.init.init_instance_callback)&&e.init.init_instance_callback(p)}};e.inline||(t.style.visibility=""),V(t)&&(t.value=f()),d.init(k)};J(()=>{if(K(g())!==null)T();else{if(Array.isArray(e.tinymceScriptSrc)&&e.tinymceScriptSrc.length===0)throw new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array.");if(e?.elementRef?.ownerDocument){const r=()=>{T()},t=d=>{throw new Error(d)};sn.loadList(e.elementRef.ownerDocument,h(),e.scriptLoading?.delay??0,r,t)}}}),q(()=>{const r=i();typeof r<"u"&&(r.off(O(),E),r.off(B(),w),r.off("keypress",M),r.off("keydown",P),r.off("NewBlock",E),Object.keys(C()).forEach(t=>{r.off(t,C()[t])}),m({}),r.remove(),a(void 0))});const O=()=>K(g())?.Env?.browser?.isIE()?"change keyup compositionend setcontent CommentChange":"change input compositionend setcontent CommentChange",B=()=>nn()?"beforeinput SelectionChange":"SelectionChange",E=r=>{const t=i();if(t&&t.initialized){const d=t.getContent();e.value!==void 0&&e.value!==d&&e.rollback!==!1&&(s()||u(window.setTimeout($,typeof e.rollback=="number"?e.rollback:200))),d!==c()&&(l(d),x(e.onEditorChange)&&e.onEditorChange(d,t))}},$=()=>{const r=i(),t=e.value;r&&t&&t!==c()&&r.undoManager.ignore(()=>{if(r.setContent(t),y()&&(!e.inline||r.hasFocus()))try{r.selection.moveToBookmark(y())}catch{}}),u(void 0)},w=r=>{const t=i();if(e.value!==void 0&&e.value===c()&&t&&(!e.inline||t.hasFocus()))try{b(t.selection.getBookmark(3))}catch{}},M=r=>{(r.key==="Enter"||r.key==="Backspace"||r.key==="Delete")&&w()},P=r=>{(r.key==="Enter"||r.key==="Backspace"||r.key==="Delete")&&w()};return e.inline?R(an,A(),"display:"+(i()?"":"none"),I("id",S(e.id,!0)||S(N("solid-tinymce-editor"),!0),!1)+I("tabindex",S(e.tabIndex,!0),!1)):R(ln,A(),"display:"+(i()?"":"none"),I("id",S(e.id,!0)||S(N("solid-tinymce-editor"),!0),!1)+I("tabindex",S(e.tabIndex,!0),!1))};un.EditorPropTypes=W;export{un as default};
